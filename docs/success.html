<!doctype html>
<html lang="es">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Pago confirmado</title></head>
<body style="font-family:system-ui,Arial;padding:24px">
  <h1>Pago confirmado</h1>
  <p>Verificandoâ€¦</p>
  <script>
    const qs = new URLSearchParams(location.search);
    const session_id = qs.get("session_id");

    async function run(){
      if(!session_id){ document.body.innerHTML += "<p>Falta session_id</p>"; return; }

      const res = await fetch("iravlisto-pay.xqwertyx.workers.dev
", {
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body: JSON.stringify({ session_id })
      });

      const data = await res.json();
      if(data.ok){
        localStorage.setItem("iravlisto_unlocked","1");
        location.href = "/iravlisto/#calc";
      } else {
        document.body.innerHTML += "<p>No se pudo verificar el pago.</p>";
      }
    }
    run();
  </script>
</body>
</html>
